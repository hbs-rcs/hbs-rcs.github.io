---
title: Health Insurance Model
date: '2017-02-15'
author: 'Andrew Marder'
---

```{r, echo = FALSE, message = FALSE}
library(ggplot2)
library(knitr)
library(dplyr)

opts_chunk$set(echo = FALSE)
```

Consider an individual's choice of how much health insurance to buy. Imagine there are two goods the individual needs to choose between. She must choose how much health insurance to purchase $x_h$ and how much of a generic consumption good to consume $x_c$. She maximizes her utility from these two goods subject to her budget constraint (the total amount spent on both goods cannot exceed her wealth $w$):

$$
\begin{aligned}
& \underset{x_h, x_c}{\text{maximize}}
& & u(x_h, x_c) \\
& \text{subject to}
& & p_h x_h + x_c \le w.
\end{aligned}
$$

Notice that I have normalized the price of the generic good to one. 

```{r, warning = FALSE}
p_h <- 5
w <- 75
x_c_star <- w / 2
x_h_star <- w / 2 / p_h
u_star <- (w - x_c_star) / p_h * x_c_star

data <- data.frame(x_c = 0:w) %>%
    mutate(
        x_h = (w - x_c) / p_h,
        x_h = ifelse(x_h < 0, NA, x_h),
        indifference = u_star / x_c
    )

ggplot() +
    geom_line(aes(x = x_c, y = x_h), data) +
    geom_line(aes(x = x_c, y = indifference), data %>% filter(indifference <= 25)) +
    theme_bw() +
    scale_y_continuous(
        name = "Health Insurance",
        breaks = c(0, x_h_star, w / p_h),
        labels = c("0", ~ x[h]^o, ~ frac(w, p[h])),
        minor_breaks = NULL
    ) +
    scale_x_continuous(
        name = "Other Consumption Goods",
        breaks = c(0, x_c_star, w),
        labels = c("0", ~ x[c]^o, "w"),
        minor_breaks = NULL
    )
```
